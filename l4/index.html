<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>L4â€“L5 Rehab Tracker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@500&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }
    ::-webkit-scrollbar { display: none; }
    html, body { height: 100%; background: #0F0F1A; color: #E8E8F0; font-family: 'DM Sans', 'Helvetica Neue', sans-serif; }

    #app { max-width: 430px; margin: 0 auto; min-height: 100vh; position: relative; padding-bottom: 80px; }

    /* HEADER */
    .header { background: linear-gradient(135deg, #0F0F1A 0%, #1A1A2E 100%); padding: 20px 20px 0; border-bottom: 1px solid #1E1E30; position: sticky; top: 0; z-index: 10; }
    .header-top { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 16px; }
    .header-label { font-size: 11px; letter-spacing: 3px; color: #666; text-transform: uppercase; margin-bottom: 4px; }
    .header-title { font-size: 22px; font-weight: 700; color: #fff; }
    .phase-badge { border-radius: 10px; padding: 6px 12px; text-align: center; }
    .phase-badge-label { font-size: 10px; letter-spacing: 1px; text-transform: uppercase; }
    .phase-badge-name { font-size: 14px; font-weight: 700; }

    /* NAV TABS */
    .nav-tabs { display: flex; gap: 2px; }
    .nav-tab { flex: 1; padding: 10px 0; background: none; border: none; border-bottom: 2px solid transparent; color: #555; font-weight: 600; font-size: 13px; cursor: pointer; text-transform: capitalize; letter-spacing: 0.5px; transition: all 0.2s; font-family: inherit; }
    .nav-tab.active { border-bottom-color: var(--phase-color); color: var(--phase-color); }

    /* VIEWS */
    .view { padding: 20px 16px; display: none; }
    .view.active { display: block; }

    /* PHASE SELECTOR */
    .phase-selector { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 8px; margin-bottom: 20px; }
    .phase-btn { flex-shrink: 0; padding: 8px 14px; border-radius: 20px; border: 1px solid #2A2A3A; background: #1A1A2E; color: #666; font-weight: 600; font-size: 12px; cursor: pointer; transition: all 0.2s; font-family: inherit; }
    .phase-btn.active { color: #fff; }

    /* SESSION TABS */
    .session-tabs { display: flex; gap: 8px; margin-bottom: 20px; overflow-x: auto; }
    .session-tab { flex-shrink: 0; padding: 8px 14px; border-radius: 10px; border: 1px solid #2A2A3A; background: none; color: #555; font-weight: 500; font-size: 13px; cursor: pointer; transition: all 0.2s; font-family: inherit; }
    .session-tab.active { background: #1E1E30; color: #fff; }

    /* PROGRESS BAR */
    .progress-wrap { margin-bottom: 24px; }
    .progress-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
    .progress-label { font-size: 13px; color: #888; }
    .progress-count { font-size: 13px; font-weight: 700; color: var(--phase-color); }
    .progress-track { height: 6px; background: #1E1E30; border-radius: 3px; overflow: hidden; }
    .progress-fill { height: 100%; border-radius: 3px; transition: width 0.4s ease; }

    /* EXERCISE CARDS */
    .exercise-list { display: flex; flex-direction: column; gap: 10px; }
    .ex-card { border-radius: 14px; overflow: hidden; transition: all 0.2s; border: 1px solid #1E1E30; background: #141420; }
    .ex-card.checked { border-color: var(--phase-color-alpha); background: var(--phase-color-bg); }
    .ex-row { padding: 14px 14px 10px; display: flex; align-items: center; gap: 10; }
    .ex-checkbox { width: 28px; height: 28px; border-radius: 8px; border: 2px solid #333; background: none; flex-shrink: 0; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
    .ex-checkbox.checked { border-color: var(--phase-color); background: var(--phase-color); }
    .ex-checkbox .check-icon { color: #fff; font-size: 14px; display: none; }
    .ex-checkbox.checked .check-icon { display: block; }
    .ex-info { flex: 1; min-width: 0; }
    .ex-name { font-weight: 600; font-size: 15px; color: #CCC; margin-bottom: 3px; }
    .ex-card.checked .ex-name { color: #fff; }
    .ex-meta { font-size: 12px; color: #555; font-family: 'DM Mono', monospace; }
    .ex-actions { display: flex; gap: 5px; flex-shrink: 0; }
    .ex-btn { width: 30px; height: 30px; border-radius: 8px; border: 1px solid #2A2A3A; background: none; color: #555; cursor: pointer; font-size: 13px; display: flex; align-items: center; justify-content: center; transition: all 0.2s; font-family: inherit; }
    .ex-btn.play-btn { font-weight: 700; }
    .ex-btn.log-btn.has-log { border-color: var(--phase-color-alpha); background: var(--phase-color-bg); color: var(--phase-color); }

    /* EXPANDED PANEL */
    .ex-expanded { padding: 0 14px 14px 14px; display: none; }
    .ex-expanded.open { display: block; }
    .ex-tip { background: #0F0F1A; border-radius: 8px; padding: 10px 12px; font-size: 13px; color: #8A9BB0; line-height: 1.5; border-left: 3px solid var(--phase-color); margin-bottom: 12px; }
    .video-thumb-wrap { position: relative; cursor: pointer; border-radius: 12px; overflow: hidden; display: block; width: 100%; border: none; padding: 0; background: none; }
    .video-thumb-wrap img { width: 100%; display: block; border-radius: 12px; }
    .video-thumb-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; border-radius: 12px; }
    .video-play-circle { width: 48px; height: 48px; border-radius: 50%; background: var(--phase-color); display: flex; align-items: center; justify-content: center; font-size: 20px; padding-left: 4px; box-shadow: 0 4px 16px var(--phase-color-shadow); }
    .video-thumb-label { position: absolute; bottom: 8px; left: 10px; font-size: 11px; color: #fff; font-weight: 600; text-shadow: 0 1px 4px rgba(0,0,0,0.9); }

    /* LOG CHIPS */
    .log-chips { padding: 0 14px 10px 52px; display: flex; gap: 8px; flex-wrap: wrap; }
    .log-chip { font-size: 11px; background: #1E1E30; padding: 3px 8px; border-radius: 6px; color: #888; }
    .log-chip.pain-low { color: #4A9B8E; }
    .log-chip.pain-mid { color: #E8A838; }
    .log-chip.pain-high { color: #C94F4F; }

    /* WARNING */
    .warning { margin-top: 24px; padding: 12px 14px; background: rgba(201,79,79,0.07); border: 1px solid rgba(201,79,79,0.2); border-radius: 12px; font-size: 12px; color: rgba(201,79,79,0.55); line-height: 1.5; }

    /* PHASES VIEW */
    .phase-card { width: 100%; background: #141420; border: 1px solid #1E1E30; border-radius: 14px; padding: 16px; margin-bottom: 10px; cursor: pointer; text-align: left; display: flex; align-items: center; gap: 16px; font-family: inherit; transition: all 0.2s; }
    .phase-card.active-phase { border-color: var(--card-color-alpha); }
    .phase-icon { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0; }
    .phase-card-body { flex: 1; }
    .phase-card-header { display: flex; justify-content: space-between; align-items: center; }
    .phase-card-name { font-weight: 700; font-size: 15px; color: #fff; }
    .phase-weeks-badge { font-size: 11px; padding: 3px 8px; border-radius: 6px; }
    .phase-card-sub { font-size: 13px; color: #777; margin-top: 3px; }
    .phase-card-count { font-size: 12px; color: #555; margin-top: 4px; }
    .phase-arrow { color: #333; font-size: 18px; }

    /* HISTORY */
    .cal-strip { display: flex; gap: 6px; margin-bottom: 24px; overflow-x: auto; }
    .cal-day { flex-shrink: 0; width: 44px; text-align: center; border-radius: 10px; padding: 8px 4px; border: 1px solid #1E1E30; background: #141420; }
    .cal-day-name { font-size: 10px; color: #555; margin-bottom: 4px; }
    .cal-day-num { font-size: 13px; font-weight: 700; color: #444; }
    .cal-day-count { font-size: 10px; color: #555; margin-top: 4px; font-weight: 600; }
    .history-label { font-size: 12px; color: #666; margin-bottom: 12px; letter-spacing: 1px; text-transform: uppercase; }
    .history-item { background: #141420; border: 1px solid #1E1E30; border-radius: 10px; padding: 12px 14px; margin-bottom: 8px; display: flex; align-items: center; gap: 12px; }
    .history-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
    .history-name { font-size: 14px; font-weight: 600; color: #CCC; }
    .history-meta { font-size: 11px; color: #555; margin-top: 2px; }
    .history-pain { font-size: 12px; font-weight: 700; }
    .empty-history { text-align: center; padding: 40px; color: #444; font-size: 14px; line-height: 1.8; }

    /* VIDEO MODAL */
    .video-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.93); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 300; padding: 16px; display: none; }
    .video-modal.open { display: flex; }
    .video-modal-inner { width: 100%; max-width: 430px; }
    .video-modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; padding: 0 2px; }
    .video-modal-title { font-size: 15px; font-weight: 700; color: #fff; }
    .video-close-btn { background: #1E1E30; border: none; border-radius: 8px; padding: 7px 14px; color: #aaa; cursor: pointer; font-size: 13px; font-weight: 600; font-family: inherit; }
    .video-ratio { position: relative; padding-bottom: 56.25%; height: 0; border-radius: 16px; overflow: hidden; }
    .video-ratio iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
    .video-hint { text-align: center; font-size: 12px; color: #444; margin-top: 10px; }

    /* LOG MODAL */
    .log-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: flex; align-items: flex-end; z-index: 200; display: none; }
    .log-modal.open { display: flex; }
    .log-modal-inner { background: #141420; width: 100%; max-width: 430px; margin: 0 auto; border-radius: 20px 20px 0 0; padding: 24px 20px 40px; border: 1px solid #1E1E30; border-bottom: none; }
    .log-modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .log-modal-title { font-weight: 700; font-size: 17px; color: #fff; }
    .log-modal-sub { font-size: 12px; color: #555; margin-top: 2px; }
    .modal-close-btn { background: #1E1E30; border: none; border-radius: 8px; padding: 6px 10px; color: #777; cursor: pointer; font-family: inherit; font-size: 14px; }
    .log-row { display: flex; gap: 10px; margin-bottom: 20px; }
    .log-field { flex: 1; }
    .log-field label { display: block; font-size: 12px; color: #666; margin-bottom: 6px; }
    .log-field input, .log-field textarea { width: 100%; background: #0F0F1A; border: 1px solid #2A2A3A; border-radius: 8px; padding: 10px 12px; color: #fff; font-size: 15px; font-family: inherit; outline: none; }
    .log-field textarea { font-size: 14px; resize: none; }
    .log-section-label { font-size: 12px; color: #666; margin-bottom: 8px; }
    .log-section { margin-bottom: 20px; }
    .pain-dots { display: flex; gap: 5px; flex-wrap: wrap; }
    .pain-dot { width: 30px; height: 30px; border-radius: 50%; border: none; background: #2A2A3A; color: #555; font-weight: 700; font-size: 12px; cursor: pointer; transition: all 0.15s; font-family: inherit; }
    .diff-btns { display: flex; gap: 6px; }
    .diff-btn { flex: 1; padding: 8px 0; border-radius: 8px; border: none; background: #2A2A3A; color: #555; font-weight: 600; font-size: 11px; cursor: pointer; transition: all 0.15s; font-family: inherit; }
    .save-btn { width: 100%; padding: 16px; border: none; border-radius: 12px; color: #fff; font-weight: 700; font-size: 16px; cursor: pointer; font-family: inherit; background: var(--phase-color); }

    /* SAVED TOAST */
    .saved-toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #4A9B8E; color: #fff; padding: 10px 20px; border-radius: 20px; font-weight: 600; font-size: 14px; z-index: 500; box-shadow: 0 4px 20px rgba(74,155,142,0.4); display: none; pointer-events: none; }
    .saved-toast.show { display: block; animation: fadeInOut 1.5s forwards; }
    @keyframes fadeInOut { 0%{opacity:0;transform:translateX(-50%) translateY(-6px)} 15%{opacity:1;transform:translateX(-50%) translateY(0)} 75%{opacity:1} 100%{opacity:0} }
  </style>
</head>
<body>
<div id="app">

  <!-- HEADER -->
  <div class="header" id="header">
    <div class="header-top">
      <div>
        <div class="header-label">L4â€“L5 Recovery</div>
        <div class="header-title">Rehab Tracker</div>
      </div>
      <div class="phase-badge" id="phase-badge">
        <div class="phase-badge-label" id="badge-label">Active</div>
        <div class="phase-badge-name" id="badge-name">Phase 1</div>
      </div>
    </div>
    <div class="nav-tabs">
      <button class="nav-tab active" data-view="today">Today</button>
      <button class="nav-tab" data-view="phases">Phases</button>
      <button class="nav-tab" data-view="history">History</button>
    </div>
  </div>

  <!-- TODAY VIEW -->
  <div class="view active" id="view-today">
    <div class="phase-selector" id="phase-selector"></div>
    <div class="session-tabs" id="session-tabs"></div>
    <div class="progress-wrap">
      <div class="progress-header">
        <span class="progress-label" id="session-label"></span>
        <span class="progress-count" id="progress-count"></span>
      </div>
      <div class="progress-track"><div class="progress-fill" id="progress-fill"></div></div>
    </div>
    <div class="exercise-list" id="exercise-list"></div>
    <div class="warning">ðŸ›‘ Stop immediately if you feel leg pain, shooting pain, or numbness during any exercise.</div>
  </div>

  <!-- PHASES VIEW -->
  <div class="view" id="view-phases">
    <div style="font-size:13px;color:#666;margin-bottom:20px;">Your full 5-phase program overview</div>
    <div id="phases-list"></div>
  </div>

  <!-- HISTORY VIEW -->
  <div class="view" id="view-history">
    <div style="font-size:13px;color:#666;margin-bottom:20px;">Last 14 days of activity</div>
    <div class="cal-strip" id="cal-strip"></div>
    <div class="history-label">Recent Sessions</div>
    <div id="history-list"></div>
  </div>

</div>

<!-- VIDEO MODAL -->
<div class="video-modal" id="video-modal">
  <div class="video-modal-inner" id="video-modal-inner">
    <div class="video-modal-header">
      <div class="video-modal-title" id="video-modal-title"></div>
      <button class="video-close-btn" id="video-close-btn">âœ• Close</button>
    </div>
    <div class="video-ratio" id="video-ratio"></div>
    <p class="video-hint">Tap outside to close</p>
  </div>
</div>

<!-- LOG MODAL -->
<div class="log-modal" id="log-modal">
  <div class="log-modal-inner" id="log-modal-inner">
    <div class="log-modal-header">
      <div>
        <div class="log-modal-title" id="log-modal-title"></div>
        <div class="log-modal-sub" id="log-modal-sub"></div>
      </div>
      <button class="modal-close-btn" id="log-close-btn">âœ•</button>
    </div>
    <div class="log-row">
      <div class="log-field">
        <label>Sets completed</label>
        <input type="text" id="log-sets" placeholder="">
      </div>
      <div class="log-field">
        <label>Reps / Time</label>
        <input type="text" id="log-reps" placeholder="">
      </div>
    </div>
    <div class="log-section">
      <div class="log-section-label">Pain level (0 = none, 10 = severe)</div>
      <div class="pain-dots" id="pain-dots"></div>
    </div>
    <div class="log-section">
      <div class="log-section-label">Difficulty</div>
      <div class="diff-btns" id="diff-btns"></div>
    </div>
    <div class="log-section">
      <div class="log-field">
        <label>Notes (optional)</label>
        <textarea id="log-notes" rows="2" placeholder="How did it feel? Any observations..."></textarea>
      </div>
    </div>
    <button class="save-btn" id="save-log-btn">Save Log</button>
  </div>
</div>

<!-- TOAST -->
<div class="saved-toast" id="saved-toast">âœ“ Saved</div>

<script>
// â”€â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const VIDEOS = {
  "p1-m1": { id: "oDJUpwxIbYA", title: "Prone Lying" },
  "p1-m2": { id: "eVMCGK4tc4U", title: "McKenzie Press-Up" },
  "p1-m3": { id: "GSQMPGFpOyU", title: "Knee to Chest Stretch" },
  "p1-m4": { id: "OUgsJ8-Vi0E", title: "Glute Bridge" },
  "p1-e1": { id: "kqnua4rHVVA", title: "Cat-Cow" },
  "p1-e2": { id: "YQmpDfNoFIo", title: "Hip Flexor Stretch" },
  "p1-e3": { id: "kFiNiXKyqdM", title: "Piriformis Stretch" },
  "p1-d1": { id: "njeZ29umqVE", title: "Walking for Back Pain" },
  "p2-s1": { id: "wiFNA3sqjCA", title: "Bird-Dog" },
  "p2-s2": { id: "4XLEnwUr1d8", title: "Dead Bug" },
  "p2-s3": { id: "tFq7KnHHb3E", title: "Side-Lying Clam" },
  "p2-s4": { id: "2LPHYFkI1WU", title: "Single-Leg Glute Bridge" },
  "p2-s5": { id: "y-wV4Venusw", title: "Wall Sit" },
  "p2-s6": { id: "AKed5fMRNLQ", title: "Pallof Press" },
  "p3-a1": { id: "jEy_czb3RKA", title: "Romanian Deadlift" },
  "p3-a2": { id: "MxsFDhcyFyE", title: "Goblet Squat" },
  "p3-a3": { id: "dQqApCGd5Ss", title: "Step-Up" },
  "p3-a4": { id: "3bSqDOReFUs", title: "Nordic Hamstring Curl" },
  "p3-a5": { id: "2LPHYFkI1WU", title: "Single-Leg Glute Bridge" },
  "p3-b1": { id: "eGo4IYlbE5g", title: "Pull-Up" },
  "p3-b2": { id: "GZbfZ033f74", title: "Cable Row" },
  "p3-b3": { id: "IODxDxX7oi4", title: "Push-Up" },
  "p3-b4": { id: "rt17lmnaLSM", title: "Farmer Carry" },
  "p3-b5": { id: "AKed5fMRNLQ", title: "Pallof Press" },
  "p3-c1": { id: "XxWcirHIwVo", title: "Trap Bar Deadlift" },
  "p3-c2": { id: "2C-uNgKwPLE", title: "Bulgarian Split Squat" },
  "p3-c3": { id: "YPeGLK3cN6M", title: "Cable Woodchop" },
  "p3-c4": { id: "rt17lmnaLSM", title: "Suitcase Carry" },
  "p3-c5": { id: "lgFBNr0tnPs", title: "Copenhagen Plank" },
  "p4-s1": { id: "cPyLSQ6dMYQ", title: "Box Jump" },
  "p4-s2": { id: "8BFtXOFqVz8", title: "Lateral Bound" },
  "p4-s3": { id: "A-cFYWvaHr0", title: "Jump Squat" },
  "p4-s4": { id: "2C-uNgKwPLE", title: "Deficit Split Squat" },
  "p4-s5": { id: "HPEpDCOHDsk", title: "Rotational Med Ball Throw" },
  "p4-s6": { id: "UN-VqpqHzrQ", title: "Single-Leg RDL" },
  "p4-s7": { id: "AFoqaivFEpg", title: "Bosu Balance" },
  "p4-s8": { id: "mKDIuUbH94Q", title: "Kettlebell Swing" },
  "p5-m1": { id: "XxWcirHIwVo", title: "Strength Session" },
  "p5-m2": { id: "njeZ29umqVE", title: "Walking" },
  "p5-m3": { id: "eVMCGK4tc4U", title: "Morning Mobility" },
};

const PHASES = [
  { id:1, name:"Phase 1", subtitle:"Pain Relief & Movement", weeks:"Weeks 1â€“3", color:"#4A9B8E", emoji:"ðŸŒ±",
    sessions:[
      { id:"p1-morning", name:"Morning Session", emoji:"ðŸŒ…", exercises:[
        { id:"p1-m1", name:"Prone Lying", sets:"1", reps:"5 min", tip:"Just lie on stomach. Passive extension. Let spine decompress." },
        { id:"p1-m2", name:"Prone Press-Up (McKenzie)", sets:"2", reps:"10 reps", tip:"Press upper body up, hips stay down. Stop if leg pain appears." },
        { id:"p1-m3", name:"Single Knee-to-Chest", sets:"1", reps:"30 sec each", tip:"One leg at a time only â€” NOT both together." },
        { id:"p1-m4", name:"Glute Bridge", sets:"3", reps:"10 reps", tip:"Slow and controlled. Squeeze glutes at top. Neutral spine." },
      ]},
      { id:"p1-evening", name:"Evening Session", emoji:"ðŸŒ™", exercises:[
        { id:"p1-e1", name:"Cat-Cow", sets:"2", reps:"10 reps", tip:"Slow, fluid movement. Move with breath." },
        { id:"p1-e2", name:"Hip Flexor Stretch", sets:"2", reps:"45 sec each", tip:"Kneeling. Tight hip flexors pull on lumbar spine â€” essential." },
        { id:"p1-e3", name:"Piriformis Stretch", sets:"2", reps:"45 sec each", tip:"Figure-4 position. Helps with hip discomfort." },
      ]},
      { id:"p1-daily", name:"Daily Habit", emoji:"ðŸš¶", exercises:[
        { id:"p1-d1", name:"Walk", sets:"1", reps:"20â€“30 min", tip:"Comfortable pace. Therapeutic â€” promotes disc nutrition." },
      ]}
    ]
  },
  { id:2, name:"Phase 2", subtitle:"Foundational Stability", weeks:"Weeks 4â€“6", color:"#5B8DB8", emoji:"ðŸ—ï¸",
    sessions:[
      { id:"p2-stability", name:"Stability Session", emoji:"ðŸ—ï¸", exercises:[
        { id:"p2-s1", name:"Bird-Dog", sets:"3", reps:"8 each side", tip:"Best exercise for L4-L5. Opposite arm and leg, hold 3 sec. No rotation." },
        { id:"p2-s2", name:"Dead Bug", sets:"3", reps:"8 each side", tip:"Lower back pressed into floor throughout. Control every rep." },
        { id:"p2-s3", name:"Side-Lying Clam", sets:"3", reps:"15 each side", tip:"With resistance band. Activates glute medius â€” key for hip stability." },
        { id:"p2-s4", name:"Single-Leg Glute Bridge", sets:"3", reps:"10 each side", tip:"Forces each side to work independently." },
        { id:"p2-s5", name:"Wall Sit", sets:"3", reps:"30â€“45 sec", tip:"Spine neutral against wall. Builds leg/glute strength without spinal load." },
        { id:"p2-s6", name:"Pallof Press (band)", sets:"3", reps:"10 each side", tip:"Anti-rotation core work. Excellent for disc protection." },
      ]}
    ]
  },
  { id:3, name:"Phase 3", subtitle:"Strength Building", weeks:"Weeks 7â€“12", color:"#8B6BB1", emoji:"ðŸ’ª",
    sessions:[
      { id:"p3-a", name:"Session A â€” Lower Body", emoji:"ðŸ‹ï¸", exercises:[
        { id:"p3-a1", name:"Romanian Deadlift", sets:"4", reps:"8â€“10", tip:"Hip hinge, not squat. Neutral spine always. Start light." },
        { id:"p3-a2", name:"Goblet Squat", sets:"3", reps:"10â€“12", tip:"To parallel only. Heels slightly elevated if needed." },
        { id:"p3-a3", name:"Step-Up (weighted)", sets:"3", reps:"10 each", tip:"Drive through heel. Great snowboard prep." },
        { id:"p3-a4", name:"Nordic Hamstring Curl", sets:"3", reps:"6â€“8", tip:"Slow eccentric. One of the best posterior chain builders." },
        { id:"p3-a5", name:"Single-Leg Glute Bridge", sets:"3", reps:"12 each", tip:"Can add band resistance at knee." },
      ]},
      { id:"p3-b", name:"Session B â€” Upper + Core", emoji:"ðŸ’ª", exercises:[
        { id:"p3-b1", name:"Pull-Up / Lat Pulldown", sets:"4", reps:"6â€“8", tip:"Decompresses spine. Control the descent." },
        { id:"p3-b2", name:"Cable Row", sets:"3", reps:"10â€“12", tip:"Seated, neutral spine. Builds thoracic extensors." },
        { id:"p3-b3", name:"Push-Up", sets:"3", reps:"10â€“15", tip:"Core bracing throughout. No sagging hips." },
        { id:"p3-b4", name:"Farmer Carry", sets:"3", reps:"30m walk", tip:"Builds spinal stiffness and grip. Spine tall." },
        { id:"p3-b5", name:"Pallof Press (cable)", sets:"3", reps:"12 each", tip:"Increase resistance from Phase 2." },
      ]},
      { id:"p3-c", name:"Session C â€” Full Body", emoji:"âš¡", exercises:[
        { id:"p3-c1", name:"Trap Bar Deadlift", sets:"4", reps:"6â€“8", tip:"More spine-friendly than barbell. Progress load over weeks." },
        { id:"p3-c2", name:"Bulgarian Split Squat", sets:"3", reps:"8 each", tip:"Single-leg strength + hip mobility. Essential for snowboarding." },
        { id:"p3-c3", name:"Cable Woodchop", sets:"3", reps:"12 each", tip:"Rotational strength. Builds snowboard-specific power." },
        { id:"p3-c4", name:"Suitcase Carry", sets:"3", reps:"30m walk", tip:"One-sided carry. Anti-lateral flexion training." },
        { id:"p3-c5", name:"Copenhagen Plank", sets:"3", reps:"20 sec each", tip:"Builds hip adductor and lateral core strength." },
      ]}
    ]
  },
  { id:4, name:"Phase 4", subtitle:"Sport-Specific Power", weeks:"Weeks 13â€“18", color:"#C4793A", emoji:"ðŸ‚",
    sessions:[
      { id:"p4-snow", name:"Snowboard Conditioning", emoji:"ðŸ‚", exercises:[
        { id:"p4-s1", name:"Box Jump", sets:"4", reps:"5 reps", tip:"Land soft, absorb through hips and knees." },
        { id:"p4-s2", name:"Lateral Bound", sets:"4", reps:"8 each", tip:"Explosive lateral push. Mimics edge-to-edge transitions." },
        { id:"p4-s3", name:"Jump Squat", sets:"3", reps:"8 reps", tip:"Explode up, land softly. Plyometric power." },
        { id:"p4-s4", name:"Deficit Split Squat", sets:"4", reps:"8 each", tip:"Deep range for hip mobility under load." },
        { id:"p4-s5", name:"Rotational Med Ball Throw", sets:"3", reps:"10 each", tip:"Builds torso rotation power for turns." },
        { id:"p4-s6", name:"Single-Leg RDL", sets:"3", reps:"10 each", tip:"Balance and posterior chain. Essential for uneven terrain." },
        { id:"p4-s7", name:"Bosu Balance", sets:"3", reps:"60 sec", tip:"Proprioceptive training. Mimics unstable snow surface." },
        { id:"p4-s8", name:"Kettlebell Swing", sets:"4", reps:"12 reps", tip:"Explosive hip extension. Directly translates to carving power." },
      ]}
    ]
  },
  { id:5, name:"Phase 5", subtitle:"Return to Snow â„ï¸", weeks:"Week 19+", color:"#3A8CB5", emoji:"â„ï¸",
    sessions:[
      { id:"p5-maintain", name:"Maintenance", emoji:"ðŸŽ¿", exercises:[
        { id:"p5-m1", name:"Strength Training", sets:"3x/week", reps:"Phase 3 volume", tip:"Never stop entirely â€” most recurrences happen off-season." },
        { id:"p5-m2", name:"Daily Walk", sets:"Daily", reps:"30 min", tip:"Permanent habit for disc health." },
        { id:"p5-m3", name:"Morning Mobility", sets:"Daily", reps:"15 min", tip:"Press-ups, hip flexor stretch, hip mobility. Year-round." },
      ]}
    ]
  }
];

// â”€â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const STORAGE_KEY = "rehab-tracker-v2";
let state = {
  activePhase: 0,
  activeSession: 0,
  view: "today",
  expandedEx: null,
  logs: {},
  logModalEx: null,
  logPain: 0,
  logDiff: 0,
};

function getTodayKey() { return new Date().toISOString().split("T")[0]; }
function getLogKey(exId) { return `${getTodayKey()}__${exId}`; }

function loadLogs() {
  try { const s = localStorage.getItem(STORAGE_KEY); if (s) state.logs = JSON.parse(s); } catch(e) {}
}
function saveLogs() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state.logs));
}

// â”€â”€â”€ CSS VARIABLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function applyPhaseColor(color) {
  const r = parseInt(color.slice(1,3),16);
  const g = parseInt(color.slice(3,5),16);
  const b = parseInt(color.slice(5,7),16);
  document.documentElement.style.setProperty('--phase-color', color);
  document.documentElement.style.setProperty('--phase-color-alpha', `${color}44`);
  document.documentElement.style.setProperty('--phase-color-bg', `${color}18`);
  document.documentElement.style.setProperty('--phase-color-shadow', `rgba(${r},${g},${b},0.4)`);
}

// â”€â”€â”€ RENDER HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function hex(color, alpha) {
  return color + alpha;
}

function renderPhaseSelector() {
  const el = document.getElementById("phase-selector");
  el.innerHTML = PHASES.map((p, i) => `
    <button class="phase-btn ${i === state.activePhase ? 'active' : ''}" 
      style="${i === state.activePhase ? `background:${p.color};border-color:${p.color};` : ''}"
      onclick="selectPhase(${i})">${p.name}</button>
  `).join('');
}

function renderSessionTabs() {
  const phase = PHASES[state.activePhase];
  const el = document.getElementById("session-tabs");
  if (phase.sessions.length <= 1) { el.innerHTML = ''; el.style.display = 'none'; return; }
  el.style.display = 'flex';
  el.innerHTML = phase.sessions.map((s, i) => `
    <button class="session-tab ${i === state.activeSession ? 'active' : ''}"
      style="${i === state.activeSession ? `border-color:${phase.color}66;` : ''}"
      onclick="selectSession(${i})">${s.emoji} ${s.name}</button>
  `).join('');
}

function renderProgress() {
  const phase = PHASES[state.activePhase];
  const session = phase.sessions[state.activeSession];
  const total = session.exercises.length;
  const done = session.exercises.filter(e => !!state.logs[getLogKey(e.id)]).length;
  const pct = total ? Math.round((done/total)*100) : 0;

  document.getElementById("session-label").textContent = `${session.emoji} ${session.name}`;
  document.getElementById("progress-count").textContent = `${done}/${total} done`;
  document.getElementById("progress-count").style.color = phase.color;
  const fill = document.getElementById("progress-fill");
  fill.style.width = `${pct}%`;
  fill.style.background = `linear-gradient(90deg, ${phase.color}, ${phase.color}BB)`;
}

function renderExercises() {
  const phase = PHASES[state.activePhase];
  const session = phase.sessions[state.activeSession];
  const el = document.getElementById("exercise-list");

  el.innerHTML = session.exercises.map(ex => {
    const logKey = getLogKey(ex.id);
    const log = state.logs[logKey];
    const checked = !!log;
    const isOpen = state.expandedEx === ex.id;
    const video = VIDEOS[ex.id];

    const chipPainClass = log && log.pain > 0
      ? (log.pain <= 3 ? 'pain-low' : log.pain <= 6 ? 'pain-mid' : 'pain-high') : '';
    const chipPainColor = log && log.pain > 0
      ? (log.pain <= 3 ? '#4A9B8E' : log.pain <= 6 ? '#E8A838' : '#C94F4F') : '';

    const logChips = log && (log.sets || log.pain > 0) ? `
      <div class="log-chips">
        ${log.sets ? `<span class="log-chip">${log.sets} Ã— ${log.reps}</span>` : ''}
        ${log.pain > 0 ? `<span class="log-chip" style="color:${chipPainColor}">Pain: ${log.pain}/10</span>` : ''}
        ${log.difficulty > 0 ? `<span class="log-chip">Effort: ${['','Easy','Light','Mod','Hard','Max'][log.difficulty]}</span>` : ''}
      </div>` : '';

    const videoThumb = video ? `
      <button class="video-thumb-wrap" onclick="openVideo('${video.id}','${video.title.replace(/'/g,"\\'")}')">
        <img src="https://img.youtube.com/vi/${video.id}/mqdefault.jpg" alt="${video.title}" loading="lazy">
        <div class="video-thumb-overlay">
          <div class="video-play-circle">â–¶</div>
        </div>
        <div class="video-thumb-label">Watch Demo</div>
      </button>` : '';

    return `
      <div class="ex-card ${checked ? 'checked' : ''}" id="card-${ex.id}"
        style="--phase-color:${phase.color};--phase-color-alpha:${phase.color}44;--phase-color-bg:${phase.color}18;">
        <div class="ex-row" style="padding:14px 14px 10px;display:flex;align-items:center;gap:10px;">
          <button class="ex-checkbox ${checked ? 'checked' : ''}" onclick="toggleCheck('${ex.id}')"
            style="${checked ? `border-color:${phase.color};background:${phase.color};` : ''}">
            <span class="check-icon">âœ“</span>
          </button>
          <div class="ex-info">
            <div class="ex-name">${ex.name}</div>
            <div class="ex-meta">${ex.sets} sets Â· ${ex.reps}</div>
          </div>
          <div class="ex-actions">
            <button class="ex-btn" onclick="toggleExpand('${ex.id}')"
              style="${isOpen ? `border-color:${phase.color}66;background:${phase.color}22;color:${phase.color};` : ''}">
              ${isOpen ? 'â–²' : 'â–¼'}
            </button>
            ${video ? `<button class="ex-btn play-btn" onclick="openVideo('${video.id}','${video.title.replace(/'/g,"\\'")}');"
              style="border-color:${phase.color}44;background:${phase.color}22;color:${phase.color};">â–¶</button>` : ''}
            <button class="ex-btn log-btn ${log && log.sets ? 'has-log' : ''}" onclick="openLog('${ex.id}')"
              style="${log && log.sets ? `border-color:${phase.color}44;background:${phase.color}22;color:${phase.color};` : ''}">ðŸ“Š</button>
          </div>
        </div>
        <div class="ex-expanded ${isOpen ? 'open' : ''}">
          <div class="ex-tip" style="border-left-color:${phase.color};">ðŸ’¡ ${ex.tip}</div>
          ${videoThumb}
        </div>
        ${logChips}
      </div>`;
  }).join('');
}

function renderPhasesView() {
  const el = document.getElementById("phases-list");
  el.innerHTML = PHASES.map((p, i) => {
    const totalEx = p.sessions.reduce((a,s) => a + s.exercises.length, 0);
    return `
      <button class="phase-card ${i === state.activePhase ? 'active-phase' : ''}"
        style="--card-color-alpha:${p.color}66;"
        onclick="selectPhaseAndGo(${i})">
        <div class="phase-icon" style="background:${p.color}22;border:1px solid ${p.color}44;">${p.emoji}</div>
        <div class="phase-card-body">
          <div class="phase-card-header">
            <span class="phase-card-name">${p.name}</span>
            <span class="phase-weeks-badge" style="color:${p.color};background:${p.color}22;">${p.weeks}</span>
          </div>
          <div class="phase-card-sub">${p.subtitle}</div>
          <div class="phase-card-count">${totalEx} exercises Â· ${p.sessions.length} session${p.sessions.length>1?'s':''}</div>
        </div>
        <div class="phase-arrow">â€º</div>
      </button>`;
  }).join('');
}

function renderHistory() {
  const phase = PHASES[state.activePhase];
  const todayKey = getTodayKey();

  // Calendar strip
  const calEl = document.getElementById("cal-strip");
  const days = Array.from({length:14}, (_,i) => {
    const d = new Date(); d.setDate(d.getDate() - (13-i));
    const key = d.toISOString().split("T")[0];
    const count = Object.keys(state.logs).filter(k => k.startsWith(key+"__")).length;
    return {key, date:d, count};
  });
  calEl.innerHTML = days.map(d => {
    const isToday = d.key === todayKey;
    const bg = d.count > 0 ? `background:${phase.color}33;` : '';
    const borderColor = isToday ? phase.color : d.count > 0 ? phase.color+'44' : '#1E1E30';
    const numColor = isToday ? phase.color : d.count > 0 ? '#fff' : '#444';
    return `
      <div class="cal-day" style="${bg}border-color:${borderColor};">
        <div class="cal-day-name">${d.date.toLocaleDateString('en',{weekday:'narrow'})}</div>
        <div class="cal-day-num" style="color:${numColor};">${d.date.getDate()}</div>
        <div class="cal-day-count" style="color:${phase.color};">${d.count > 0 ? d.count : 'Â·'}</div>
      </div>`;
  }).join('');

  // History list
  const histEl = document.getElementById("history-list");
  const allEx = PHASES.flatMap(p => p.sessions.flatMap(s => s.exercises));
  const allExMap = {};
  allEx.forEach(e => allExMap[e.id] = e);

  const entries = Object.entries(state.logs)
    .sort((a,b) => (b[1].ts||0)-(a[1].ts||0))
    .slice(0,20)
    .map(([key, log]) => {
      const [dateStr, exId] = key.split("__");
      const ex = allExMap[exId];
      if (!ex) return null;
      const pc = PHASES.find(p => p.sessions.some(s => s.exercises.some(e => e.id===exId)))?.color || '#666';
      const painColor = log.pain > 0 ? (log.pain<=3?'#4A9B8E':log.pain<=6?'#E8A838':'#C94F4F') : '';
      const dateLabel = new Date(dateStr+'T12:00:00').toLocaleDateString('en',{month:'short',day:'numeric'});
      return `
        <div class="history-item">
          <div class="history-dot" style="background:${pc};"></div>
          <div style="flex:1;">
            <div class="history-name">${ex.name}</div>
            <div class="history-meta">${dateLabel}${log.sets?` Â· ${log.sets} Ã— ${log.reps}`:''}${log.pain>0?` Â· Pain ${log.pain}/10`:''}</div>
          </div>
          ${log.pain>0?`<div class="history-pain" style="color:${painColor};">${log.pain}/10</div>`:''}
        </div>`;
    }).filter(Boolean);

  if (entries.length === 0) {
    histEl.innerHTML = `<div class="empty-history">No sessions logged yet.<br><span style="color:#555;">Start on the Today tab.</span></div>`;
  } else {
    histEl.innerHTML = entries.join('');
  }
}

function renderHeader() {
  const phase = PHASES[state.activePhase];
  const badge = document.getElementById("phase-badge");
  badge.style.background = phase.color + "22";
  badge.style.border = `1px solid ${phase.color}44`;
  document.getElementById("badge-label").style.color = phase.color;
  document.getElementById("badge-name").style.color = phase.color;
  document.getElementById("badge-name").textContent = phase.name;
  applyPhaseColor(phase.color);

  // Update nav tab active color
  document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.style.setProperty('--phase-color', phase.color);
  });
}

function renderAll() {
  renderHeader();
  renderPhaseSelector();
  renderSessionTabs();
  renderProgress();
  renderExercises();
  renderPhasesView();
  renderHistory();

  // Show correct view
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.getElementById(`view-${state.view}`).classList.add('active');
  document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.classList.toggle('active', tab.dataset.view === state.view);
  });
}

// â”€â”€â”€ ACTIONS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function selectPhase(i) {
  state.activePhase = i;
  state.activeSession = 0;
  state.expandedEx = null;
  renderAll();
}

function selectPhaseAndGo(i) {
  state.activePhase = i;
  state.activeSession = 0;
  state.expandedEx = null;
  state.view = "today";
  renderAll();
}

function selectSession(i) {
  state.activeSession = i;
  state.expandedEx = null;
  renderProgress();
  renderExercises();
}

function toggleExpand(exId) {
  state.expandedEx = state.expandedEx === exId ? null : exId;
  renderExercises();
}

function toggleCheck(exId) {
  const key = getLogKey(exId);
  if (state.logs[key]) { delete state.logs[key]; }
  else { state.logs[key] = { done: true, ts: Date.now() }; }
  saveLogs();
  renderProgress();
  renderExercises();
}

// â”€â”€â”€ VIDEO MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function openVideo(videoId, title) {
  const modal = document.getElementById("video-modal");
  const phase = PHASES[state.activePhase];
  document.getElementById("video-modal-title").textContent = title;
  document.getElementById("video-ratio").innerHTML =
    `<iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen></iframe>`;
  document.getElementById("video-ratio").style.boxShadow = `0 0 40px ${phase.color}44`;
  modal.classList.add('open');
}

function closeVideo() {
  document.getElementById("video-modal").classList.remove('open');
  document.getElementById("video-ratio").innerHTML = '';
}

document.getElementById("video-close-btn").onclick = closeVideo;
document.getElementById("video-modal").onclick = function(e) {
  if (e.target === this) closeVideo();
};

// â”€â”€â”€ LOG MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function openLog(exId) {
  const phase = PHASES[state.activePhase];
  const session = phase.sessions[state.activeSession];
  const ex = session.exercises.find(e => e.id === exId)
    || PHASES.flatMap(p => p.sessions.flatMap(s => s.exercises)).find(e => e.id === exId);
  if (!ex) return;

  const log = state.logs[getLogKey(exId)] || {};
  state.logModalEx = ex;
  state.logPain = log.pain || 0;
  state.logDiff = log.difficulty || 0;

  document.getElementById("log-modal-title").textContent = ex.name;
  document.getElementById("log-modal-sub").textContent = `Target: ${ex.sets} sets Â· ${ex.reps}`;
  document.getElementById("log-sets").value = log.sets || '';
  document.getElementById("log-sets").placeholder = ex.sets;
  document.getElementById("log-reps").value = log.reps || '';
  document.getElementById("log-reps").placeholder = ex.reps;
  document.getElementById("log-notes").value = log.notes || '';
  document.getElementById("save-log-btn").style.background = phase.color;

  renderPainDots();
  renderDiffBtns();

  document.getElementById("log-modal").classList.add('open');
}

function renderPainDots() {
  const phase = PHASES[state.activePhase];
  const el = document.getElementById("pain-dots");
  el.innerHTML = Array.from({length:11}, (_,n) => {
    const active = n <= state.logPain;
    const col = active ? (n<=3?'#4A9B8E':n<=6?'#E8A838':'#C94F4F') : '#2A2A3A';
    const textCol = active ? '#fff' : '#555';
    const scale = n === state.logPain ? 'transform:scale(1.2);' : '';
    return `<button class="pain-dot" onclick="setPain(${n})"
      style="background:${col};color:${textCol};${scale}">${n}</button>`;
  }).join('');
}

function renderDiffBtns() {
  const phase = PHASES[state.activePhase];
  const labels = ['Easy','Light','Mod','Hard','Max'];
  const el = document.getElementById("diff-btns");
  el.innerHTML = labels.map((label, i) => {
    const n = i + 1;
    const active = n <= state.logDiff;
    return `<button class="diff-btn" onclick="setDiff(${n})"
      style="${active ? `background:${phase.color};color:#fff;` : ''}">${label}</button>`;
  }).join('');
}

function setPain(n) { state.logPain = n; renderPainDots(); }
function setDiff(n) { state.logDiff = n; renderDiffBtns(); }

function closeLog() {
  document.getElementById("log-modal").classList.remove('open');
  state.logModalEx = null;
}

document.getElementById("log-close-btn").onclick = closeLog;
document.getElementById("log-modal").onclick = function(e) {
  if (e.target === this) closeLog();
};
document.getElementById("log-modal-inner").onclick = function(e) { e.stopPropagation(); };

document.getElementById("save-log-btn").onclick = function() {
  if (!state.logModalEx) return;
  const key = getLogKey(state.logModalEx.id);
  state.logs[key] = {
    done: true,
    ts: Date.now(),
    sets: document.getElementById("log-sets").value,
    reps: document.getElementById("log-reps").value,
    pain: state.logPain,
    difficulty: state.logDiff,
    notes: document.getElementById("log-notes").value,
  };
  saveLogs();
  closeLog();
  renderProgress();
  renderExercises();
  renderHistory();
  showToast();
};

function showToast() {
  const t = document.getElementById("saved-toast");
  t.classList.remove('show');
  void t.offsetWidth; // reflow
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 1600);
}

// â”€â”€â”€ NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

document.querySelectorAll('.nav-tab').forEach(tab => {
  tab.onclick = function() {
    state.view = this.dataset.view;
    renderAll();
  };
});

// â”€â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

loadLogs();
renderAll();
</script>
</body>
</html>
